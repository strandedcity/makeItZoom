var z;(function(){function a(a,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(a,d.bubbles,d.cancelable,d.detail);return c}a.prototype=window.Event.prototype;window.CustomEvent=a})();function B(){console.warn.apply(console,arguments)}function aa(){console.error.apply(console,arguments)};function C(a,b){this.x=a||0;this.y=b||0}
C.prototype={constructor:C,set:function(a,b){this.x=a;this.y=b;return this},ya:function(a){this.x=a;return this},za:function(a){this.y=a;return this},a:function(a){this.x=a.x;this.y=a.y;return this},add:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a){this.x-=a.x;this.y-=a.y;return this},J:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},w:function(a){this.x*=a;this.y*=a;return this},Y:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>
a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},N:function(a){return this.x*a.x+this.y*a.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.Y(this.length())},
sa:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},clone:function(){return new C(this.x,this.y)}};function E(a,b,d){this.x=a||0;this.y=b||0;this.z=d||0}
E.prototype={constructor:E,set:function(a,b,d){this.x=a;this.y=b;this.z=d;return this},ya:function(a){this.x=a;return this},za:function(a){this.y=a;return this},a:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},J:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},w:function(a){this.x*=a;this.y*=a;this.z*=a;return this},V:function(){var a;
return function(b){void 0===a&&(a=new F);ba(a,b.C,ca(a,b.I));b=this.x;var d=this.y,c=this.z,f=a.elements,g=1/(f[3]*b+f[7]*d+f[11]*c+f[15]);this.x=(f[0]*b+f[4]*d+f[8]*c+f[12])*g;this.y=(f[1]*b+f[5]*d+f[9]*c+f[13])*g;this.z=(f[2]*b+f[6]*d+f[10]*c+f[14])*g;return this}}(),Y:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=
a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},N:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+
this.z*this.z)},normalize:function(){return this.Y(this.length())},sa:function(a){var b=this.x-a.x,d=this.y-a.y;a=this.z-a.z;return b*b+d*d+a*a},clone:function(){return new E(this.x,this.y,this.z)}};function G(a,b,d,c){this.f=a||0;this.g=b||0;this.h=d||0;this.c=void 0!==c?c:1}
G.prototype={constructor:G,f:0,g:0,h:0,c:0,get x(){return this.f},set x(a){this.f=a},get y(){return this.g},set y(a){this.g=a},get z(){return this.h},set z(a){this.h=a},get ka(){return this.c},set ka(a){this.c=a},set:function(a,b,d,c){this.f=a;this.g=b;this.h=d;this.c=c;return this},a:function(a){this.f=a.x;this.g=a.y;this.h=a.z;this.c=a.ka;return this},bb:function(){var a,b;return function(d,c){void 0===a&&(a=new E);b=d.N(c)+1;if(1E-6>b)b=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,d.x,0):a.set(0,-d.z,
d.y);else{var f=a,g=d.x,h=d.y,n=d.z,p=c.x,q=c.y,e=c.z;f.x=h*e-n*q;f.y=n*p-g*e;f.z=g*q-h*p}this.f=a.x;this.g=a.y;this.h=a.z;this.c=b;this.normalize();return this}}(),N:function(a){return this.f*a.f+this.g*a.g+this.h*a.h+this.c*a.c},length:function(){return Math.sqrt(this.f*this.f+this.g*this.g+this.h*this.h+this.c*this.c)},normalize:function(){var a=this.length();0===a?(this.h=this.g=this.f=0,this.c=1):(a=1/a,this.f=this.f*a,this.g=this.g*a,this.h=this.h*a,this.c=this.c*a);return this},clone:function(){return new G(this.f,
this.g,this.h,this.c)}};G.fb=function(){return(void 0).a(void 0).fb()};function F(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}
F.prototype={constructor:F,a:function(a){this.elements.set(a.elements);return this},w:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},scale:function(a){var b=this.elements,d=a.x,c=a.y;a=a.z;b[0]*=d;b[4]*=c;b[8]*=a;b[1]*=d;b[5]*=c;b[9]*=a;b[2]*=d;b[6]*=c;b[10]*=a;b[3]*=d;b[7]*=c;b[11]*=
a;return this}};function da(a,b,d,c,f,g,h){a=a.elements;a[0]=2*g/(d-b);a[4]=0;a[8]=(d+b)/(d-b);a[12]=0;a[1]=0;a[5]=2*g/(f-c);a[9]=(f+c)/(f-c);a[13]=0;a[2]=0;a[6]=0;a[10]=-(h+g)/(h-g);a[14]=-2*h*g/(h-g);a[3]=0;a[7]=0;a[11]=-1;a[15]=0}
function ca(a,b){var d=a.elements,c=b.elements,f=c[0],g=c[4],h=c[8],n=c[12],p=c[1],q=c[5],e=c[9],l=c[13],m=c[2],k=c[6],t=c[10],r=c[14],u=c[3],v=c[7],w=c[11],c=c[15];d[0]=e*r*v-l*t*v+l*k*w-q*r*w-e*k*c+q*t*c;d[4]=n*t*v-h*r*v-n*k*w+g*r*w+h*k*c-g*t*c;d[8]=h*l*v-n*e*v+n*q*w-g*l*w-h*q*c+g*e*c;d[12]=n*e*k-h*l*k-n*q*t+g*l*t+h*q*r-g*e*r;d[1]=l*t*u-e*r*u-l*m*w+p*r*w+e*m*c-p*t*c;d[5]=h*r*u-n*t*u+n*m*w-f*r*w-h*m*c+f*t*c;d[9]=n*e*u-h*l*u-n*p*w+f*l*w+h*p*c-f*e*c;d[13]=h*l*m-n*e*m+n*p*t-f*l*t-h*p*r+f*e*r;d[2]=q*
r*u-l*k*u+l*m*v-p*r*v-q*m*c+p*k*c;d[6]=n*k*u-g*r*u-n*m*v+f*r*v+g*m*c-f*k*c;d[10]=g*l*u-n*q*u+n*p*v-f*l*v-g*p*c+f*q*c;d[14]=n*q*m-g*l*m-n*p*k+f*l*k+g*p*r-f*q*r;d[3]=e*k*u-q*t*u-e*m*v+p*t*v+q*m*w-p*k*w;d[7]=g*t*u-h*k*u+h*m*v-f*t*v-g*m*w+f*k*w;d[11]=h*q*u-g*e*u-h*p*v+f*e*v+g*p*w-f*q*w;d[15]=g*e*m-h*q*m+h*p*k-f*e*k-g*p*t+f*q*t;d=f*d[0]+p*d[4]+m*d[8]+u*d[12];if(0==d)return B("Can't invert matrix, determinant is 0"),a.lb(),a;a.w(1/d);return a}
function ba(a,b,d){var c=b.elements;d=d.elements;a=a.elements;b=c[0];var f=c[4],g=c[8],h=c[12],n=c[1],p=c[5],q=c[9],e=c[13],l=c[2],m=c[6],k=c[10],t=c[14],r=c[3],u=c[7],v=c[11],c=c[15],w=d[0],D=d[4],x=d[8],M=d[12],N=d[1],y=d[5],A=d[9],O=d[13],H=d[2],I=d[6],S=d[10],T=d[14],U=d[3],V=d[7],W=d[11];d=d[15];a[0]=b*w+f*N+g*H+h*U;a[4]=b*D+f*y+g*I+h*V;a[8]=b*x+f*A+g*S+h*W;a[12]=b*M+f*O+g*T+h*d;a[1]=n*w+p*N+q*H+e*U;a[5]=n*D+p*y+q*I+e*V;a[9]=n*x+p*A+q*S+e*W;a[13]=n*M+p*O+q*T+e*d;a[2]=l*w+m*N+k*H+t*U;a[6]=l*D+
m*y+k*I+t*V;a[10]=l*x+m*A+k*S+t*W;a[14]=l*M+m*O+k*T+t*d;a[3]=r*w+u*N+v*H+c*U;a[7]=r*D+u*y+v*I+c*V;a[11]=r*x+u*A+v*S+c*W;a[15]=r*M+u*O+v*T+c*d};function J(){}
J.prototype={constructor:J,apply:function(a){a.addEventListener=J.prototype.addEventListener;a.hasEventListener=J.prototype.Ra;a.removeEventListener=J.prototype.Da;a.dispatchEvent=J.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this.o&&(this.o={});var d=this.o;void 0===d[a]&&(d[a]=[]);-1===d[a].indexOf(b)&&d[a].push(b)},Ra:function(a,b){if(void 0===this.o)return!1;var d=this.o;return void 0!==d[a]&&-1!==d[a].indexOf(b)?!0:!1},Da:function(a,b){if(void 0!==this.o){var d=this.o[a];
if(void 0!==d){var c=d.indexOf(b);-1!==c&&d.splice(c,1)}}},dispatchEvent:function(a){if(void 0!==this.o){var b=this.o[a.type];if(void 0!==b){a.target=this;for(var d=[],c=b.length,f=0;f<c;f++)d[f]=b[f];for(f=0;f<c;f++)d[f].call(this,a)}}}};var ea=function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),d=0,c;return function(){for(var f=0;36>f;f++)8==f||13==f||18==f||23==f?b[f]="-":14==f?b[f]="4":(2>=d&&(d=33554432+16777216*Math.random()|0),c=d&15,d>>=4,b[f]=a[19==f?c&3|8:c]);return b.join("")}}(),K=function(){var a=Math.PI/180;return function(b){return b*a}}(),fa=function(){var a=180/Math.PI;return function(b){return b*a}}();function L(){Object.defineProperty(this,"id",{value:ga++});ea();this.name="";this.type="Object3D";this.parent=void 0;this.children=[];this.hb=L.Ga.clone();Object.defineProperties(this,{position:{enumerable:!0,value:new E},ha:{enumerable:!0,value:new G},scale:{enumerable:!0,value:new E(1,1,1)}});this.B=new F;this.C=new F;this.da=!0;this.ea=!1;this.visible=!0}L.Ga=new E(0,1,0);
L.prototype={constructor:L,add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return aa("Object3D.add: object can't be added as a child of itself.",a),this;a instanceof L?(void 0!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):aa("Object3D.add: object not an instance of Object3D.",a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);
b=this.children.indexOf(a);-1!==b&&(a.parent=void 0,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))}};
function P(a,b){if(!0===a.da){var d=a.B,c=a.position,f=a.scale,g=a.ha,h=d.elements,n=g.x,p=g.y,q=g.z,e=g.ka,l=n+n,m=p+p,k=q+q,g=n*l,t=n*m,n=n*k,r=p*m,p=p*k,q=q*k,l=e*l,m=e*m,e=e*k;h[0]=1-(r+q);h[4]=t-e;h[8]=n+m;h[1]=t+e;h[5]=1-(g+q);h[9]=p-l;h[2]=n-m;h[6]=p+l;h[10]=1-(g+r);h[3]=0;h[7]=0;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;d.scale(f);d.setPosition(c);a.ea=!0}if(!0===a.ea||!0===b)void 0===a.parent?a.C.a(a.B):ba(a.C,a.parent.C,a.B),a.ea=!1,b=!0;d=0;for(c=a.children.length;d<c;d++)P(a.children[d],
b)}J.prototype.apply(L.prototype);var ga=0;function Q(){L.call(this);this.type="Camera";this.Sa=new F;this.I=new F}Q.prototype=Object.create(L.prototype);Q.prototype.constructor=Q;function R(a,b,d,c){Q.call(this);this.type="PerspectiveCamera";this.zoom=1;this.j=void 0!==a?a:50;this.L=void 0!==b?b:1;this.D=void 0!==d?d:.1;this.O=void 0!==c?c:2E3;ha(this)}R.prototype=Object.create(Q.prototype);R.prototype.constructor=R;
function ha(a){var b=fa(2*Math.atan(Math.tan(.5*K(a.j))/a.zoom));if(a.ca){var d=a.ca/a.ta,c=Math.tan(K(.5*b))*a.D,b=-c,f=d*b,d=Math.abs(d*c-f),b=Math.abs(c-b);da(a.I,f+a.x*d/a.ca,f+(a.x+a.width)*d/a.ca,c-(a.y+a.height)*b/a.ta,c-a.y*b/a.ta,a.D,a.O)}else{c=a.I;f=a.L;d=a.D;a=a.O;var b=d*Math.tan(K(.5*b)),g=-b;da(c,g*f,b*f,g,b,d,a)}}R.prototype.clone=function(){var a=new R;Q.prototype.clone.call(this,a);a.zoom=this.zoom;a.j=this.j;a.L=this.L;a.D=this.D;a.O=this.O;a.I.a(this.I);return a};function X(){L.call(this);this.type="Scene";this.ga=this.ba=null;this.qa=!0}X.prototype=Object.create(L.prototype);X.prototype.constructor=X;X.prototype.clone=function(a){void 0===a&&(a=new X);L.prototype.clone.call(this,a);null!==this.ba&&(a.ba=this.ba.clone());null!==this.ga&&(a.ga=this.ga.clone());a.qa=this.qa;a.da=this.da;return a};function Y(a){L.call(this);this.element=a;this.element.style.position="absolute";this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})}Y.prototype=Object.create(L.prototype);
function ia(a){function b(a,d){if(a instanceof Y){var c=a.element,f=e[a.id];if(void 0===f||""!==f)c.style.WebkitTransform="",c.style.MozTransform="",c.style.Ua="",c.style.transform="",e[a.id]="";c.parentNode!==k&&k.appendChild(c)}c=0;for(f=a.children.length;c<f;c++)b(a.children[c],d)}var d=1,c,f,g,h,n=!0,p=0,q="",e={},l=1,m=document.createElement("div");a&&(m=a);m.style.overflow="hidden";this.b=m;var k=document.createElement("div");m.appendChild(k);this.cb=function(a){n=a};this.Za=function(a){d=1;
"CENTER"===a&&(d=0)};this.xa=function(a,b){c=a;f=b;g=c/2;h=f/2;m.style.width=a+"px";m.style.height=b+"px";k.style.width=a+"px";k.style.height=b+"px"};this.m=function(a,c){var e=.5/Math.tan(K(.5*c.j))*f;p!==e&&(p=e);P(a);void 0===c.parent&&P(c);ca(c.Sa,c.C);var e=-c.position.x,l=c.position.y;1===d&&(e+=g,l+=h);e=" scale("+this.Pa(c,m)+") translate("+e+"px,"+l+"px)"+(n?" translate3d(0,0,0)":"");q!==e&&(k.style.WebkitTransform=e,k.style.MozTransform=e,k.style.Ua=e,q=k.style.transform=e);b(a,c)};this.Pa=
function(a,b){var d=l;if(0!==b.clientHeight||"undefined"===typeof l)l=d=.5/Math.tan(K(.5*a.j))*b.clientHeight;return d/a.position.z}};function ja(a,b){function d(a){if(!1!==e.enabled){if(1===a.button){if(!0===e.G)return;a.preventDefault();A=y.la;u.set(a.clientX,a.clientY)}else if(a.button===e.H){if(!0===e.F)return;a.preventDefault();A=y.ma;l.set(a.clientX,a.clientY);e.ja={time:new Date,Va:a}}document.addEventListener("mousemove",c,!1);document.addEventListener("mouseup",f,!1);e.dispatchEvent(H)}}function c(a){if(!1!==e.enabled){a.preventDefault();if(A===y.la){if(!0===e.G)return;v.set(a.clientX,a.clientY);w.J(v,u);0<w.y?e.Z():e.$();
u.a(v)}else if(A===y.ma){if(!0===e.F)return;m.set(a.clientX,a.clientY);k.J(m,l);e.pan(k.x,k.y);l.a(m)}e.update()}}function f(a){if(!1!==e.enabled){if(2==a.button&&"undefined"!==e.ja&&130>new Date-e.ja.time){a=e.ja.Va;var b=new CustomEvent("mz_contextmenu");b.clientX=a.clientX;b.clientY=a.clientY;b.target=a.target;a.target.dispatchEvent(b)}document.removeEventListener("mousemove",c,!1);document.removeEventListener("mouseup",f,!1);e.dispatchEvent(I);A=y.NONE}}function g(a){!0===e.W&&(e.clientX=a.clientX,
e.clientY=a.clientY,e.ia=!0);if(!1!==e.enabled&&!0!==e.G){var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?e.$():e.Z();e.update();e.dispatchEvent(H);e.dispatchEvent(I)}}function h(a){if(!1!==e.enabled&&!0!==e.Ta&&!0!==e.F)switch(a.keyCode){case e.keys.Ea:e.pan(0,e.P);e.update();break;case e.keys.Aa:e.pan(0,-e.P);e.update();break;case e.keys.Ba:e.pan(e.P,0);e.update();break;case e.keys.Ca:e.pan(-e.P,0),e.update()}}function n(a){if(!1!==e.enabled){switch(a.touches.length){case 1:return;
case 2:if(!0===e.G)return;A=y.na;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;u.set(0,Math.sqrt(b*b+a*a));break;case 3:if(!0===e.F)return;A=y.oa;l.set(a.touches[0].pageX,a.touches[0].pageY);break;default:A=y.NONE}e.dispatchEvent(H)}}function p(a){if(!1!==e.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:break;case 2:if(!0===e.G)break;if(A!==y.na)break;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;
v.set(0,Math.sqrt(b*b+a*a));w.J(v,u);0<w.y?e.$():e.Z();u.a(v);e.update();break;case 3:if(!0===e.F)break;if(A!==y.oa)break;m.set(a.touches[0].pageX,a.touches[0].pageY);k.J(m,l);e.pan(k.x,k.y);l.a(m);e.update();break;default:A=y.NONE}}function q(){!1!==e.enabled&&(e.dispatchEvent(I),A=y.NONE)}this.object=a;this.b=void 0!==b?b:document;this.X=this.enabled=!0;this.target=new E;this.G=!1;this.K=1;this.W=!0;this.S=.05;this.M=this.R=1;this.i=null;this.H=2;this.F=!1;this.P=7;this.Ta=!1;this.keys={Ba:37,Ea:38,
Ca:39,Aa:40};var e=this,l=new C,m=new C,k=new C,t=new E,r=new E,u=new C,v=new C,w=new C,D=1,x=new E,M=new E,N=new G,y={NONE:-1,la:1,ma:2,na:4,oa:5},A=y.NONE;this.gb=this.target.clone();this.Wa=this.object.position.clone();(new G).bb(a.hb,new E(0,1,0));var O={type:"change"},H={type:"start"},I={type:"end"};this.wa=function(a){D=.5/Math.tan(K(.5*this.object.j))*this.b.clientHeight/a/this.object.position.z};this.eb=function(a){this.R=a};this.va=function(a){this.S=null===this.i?a:this.Ja(this.i)};this.Ja=
function(a){return Math.min(this.b.clientWidth/(a.right-a.left),this.b.clientHeight/(a.bottom-a.top))};this.ib=function(a){if(null==a||"object"!=typeof a)return null;for(var b=["top","left","bottom","right"],d=[-1,-1,1,1],c=!1,e={},f=0;f<b.length;f++)"[object Number]"===toString.call(a[b[f]])&&(c=!0),e[b[f]]="[object Number]"===toString.call(a[b[f]])?a[b[f]]:Infinity*d[f];return c?e:(B("Invalid bounds object specified."),null)};this.$a=function(a){this.i=a=this.ib(a);null!==a&&this.va(1)};this.T=
function(a){var b=this.object.B.elements;t.set(b[0],b[1],b[2]);t.w(-a);x.add(t)};this.U=function(a){var b=this.object.B.elements;t.set(b[4],b[5],b[6]);t.w(a);x.add(t)};this.pan=function(a,b){var d=e.b===document?e.b.body:e.b;if(void 0!==e.object.j){var c=e.object.position.clone().sub(e.target).length(),c=c*Math.tan(e.object.j/2*Math.PI/180);e.T(2*a*c/d.clientHeight);e.U(2*b*c/d.clientHeight)}else void 0!==e.object.top?(e.T(a*(e.object.right-e.object.left)/d.clientWidth),e.U(b*(e.object.top-e.object.bottom)/
d.clientHeight)):console.warn("WARNING: ZoomControls.js encountered an unknown camera type - pan disabled.")};this.Z=function(){var a;void 0===a&&(a=Math.pow(.95,e.K));D/=a};this.$=function(){var a;void 0===a&&(a=Math.pow(.95,e.K));D*=a};this.V=function(a){var b=new E;b.set(e.clientX/e.b.clientWidth*2-1,2*-(e.clientY/e.b.clientHeight)+1,.5);b.V(a);var b=b.sub(a.position).normalize(),d=-a.position.z/b.z;return a.position.clone().add(b.w(d))};this.update=function(a,b){var d=!1,c;e.ia&&(c=e.V(this.object).clone());
var f=this.object.position;r.a(f).sub(this.target);var g=r.length()*D,h=.5/Math.tan(K(.5*this.object.j))*this.b.clientHeight;r.z=Math.max(h/this.R,Math.min(h/this.S,g));e.M=h/r.z;this.target.add(x);f.a(this.target).add(r);D=1;x.set(0,0,0);!0===e.ia&&!0!==a&&(d=!0,e.ia=!1,P(this.object),c=e.V(this.object).sub(c),e.T(c.x),e.U(-c.y));if(null!==e.i&&!0!==b){var m=h=g=c=0,k=this.b.clientHeight/2,l=this.b.clientWidth/2,n=l/k,p=r.z*Math.tan(K(.5*this.object.j)),n=p*n;p-k+f.y+x.y>-e.i.top&&(g+=-p-e.i.top+
k-f.y-x.y);-n+l+f.x+x.x<e.i.left&&(c+=n+e.i.left-l-f.x-x.x);+p-f.y-x.y+k>e.i.bottom&&(m+=+p-e.i.bottom+k-f.y-x.y);n+f.x+x.x+l>e.i.right&&(h+=-n+e.i.right-l-f.x-x.x);.001>Math.abs(c)&&(c=0);.001>Math.abs(h)&&(h=0);.001>Math.abs(m)&&(m=0);.001>Math.abs(g)&&(g=0);if(0!==c||0!==g||0!==h||0!==m)d=!0,k=g+m,l=c+h,0!==g&&0!==m&&(k/=2,x.za(0)),0!==c&&0!==h&&(l/=2,x.ya(0)),x.set(l+x.x,k+x.y,0)}d&&(this.target.add(x),f.a(this.target).add(r),x.set(0,0,0),D=1);if(1E-6<M.sa(this.object.position)||1E-6<8*(1-N.N(this.object.ha)))this.dispatchEvent(O),
M.a(this.object.position),N.a(this.object.ha)};this.reset=function(){A=y.NONE;this.target.a(this.gb);this.object.position.a(this.Wa);this.update()};this.aa=function(a){var b=this.b;a=!1!==a;var b={mousedown:{element:b,s:d},mousewheel:{element:b,s:g},DOMMouseScroll:{element:b,s:g},touchstart:{element:b,s:n},touchend:{element:b,s:q},touchmove:{element:b,s:p},keydown:{element:window,s:h}},c=!1!==a?"addEventListener":"removeEventListener";if(this.X!==a||!0!==this.Fa){this.Fa=!0;this.X=a;for(var e in b)b.hasOwnProperty(e)&&
b[e].element[c].apply(b[e].element,[e,b[e].s,!1])}}.bind(this);this.aa(this.X);this.update()}ja.prototype=Object.create(J.prototype);function Z(a){var b=a||{};a={};a.Ka=b.containerId||"makeItZoom";a.R=b.maxZoomScale||1;a.S=b.minZoomScale||.1;a.K=b.zoomSpeed||2;a.W=!1!==b.zoomTowardMouse;a.H="undefined"!=typeof b.panButton?b.H:2;a.ra="boolean"===typeof b.disableNativeContextMenu?b.ra:!0;a.Qa=!1!==b.hardwareAccelerated;a.fullScreen=!0===b.fullScreen;a.i=b.bounds||null;a.jb=!0!==b.zeroAtCenter;a.La=!1!==b.enableUserInteractions;this.options=a;this.l=document.getElementById(a.Ka);b=this.Ia.call(this,this.l);this.width=this.l.offsetWidth;
this.height=this.l.offsetHeight;this.v=new R(70,this.width/this.height,1,1E6);this.A=new X;this.Ya.call(this,b);this.u=new ia(this.l);this.u.Za(this.options.jb?"CENTER":"TOP_LEFT");this.u.xa(this.width,this.height);this.u.cb(a.Qa);this.u.b.style.position="absolute";this.m=this.m.bind(this);ka(this);this.controls.wa(1);la(this,a.fullScreen);this.controls.update()}z=Z.prototype;z.ab=function(a){this.controls.aa(a)};
function la(a,b){function d(){c.l.style.width=window.innerWidth;c.l.style.height=window.innerHeight;c.width=c.l.offsetWidth;c.height=c.l.offsetHeight;c.v.L=window.innerWidth/window.innerHeight;ha(c.v);c.u.xa(window.innerWidth,window.innerHeight);c.m()}var c=a;!0===b?(d(),window.addEventListener("resize",d,!1)):window.removeEventListener("resize",d,!1)}z.Na=function(){return this.l};
z.Ia=function(a){var b=this,d=[];ma(this,a,function(a){var c=b.ua(a),f=getComputedStyle(a).getPropertyValue("position");if("relative"===f||"static"===f)a.fa=c;d.push(a)});for(var c=0;c<d.length;c++){var f=d[c];a.removeChild(f);f.fa&&(f.style.position="absolute",f.style.top=f.fa.top+"px",f.style.left=f.fa.left+"px")}return d};z.Ya=function(a){for(var b=0;b<a.length;b++)this.pa.call(this,a[b])};z.pa=function(a){a=new Y(a);this.A.add(a)};
function ma(a,b,d){b=b.children;for(var c=0;c<b.length;c++)d.call(a,b[c])}function ka(a){a.controls=new ja(a.v,a.u.b);a.controls.K=a.options.K;a.controls.va(a.options.S);a.controls.eb(a.options.R);a.controls.$a(a.options.i);a.controls.aa(a.options.La);a.controls.W=a.options.W;a.controls.H=a.options.H;!0===a.options.ra&&a.controls.b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);a.controls.addEventListener("change",a.m);a.m()}
z.m=function(){this.u.m(this.A,this.v);var a={type:"mz_render"};a.mz_scale=this.controls.M;a.mz_center_x=this.controls.object.position.x;a.mz_center_y=this.controls.object.position.y;this.dispatchEvent(a)};z.Ha=function(a){this.pa(a);this.m()};
z.Xa=function(a){for(var b=null,d=0;d<this.A.children.length;d++)this.A.children[d].element===a&&(b=this.A.children[d]);null!==b?this.A.remove(b):console.warn("The specified element could not be removed from the MakeItZoom workspace, because it couldn't be found.");this.m()};z.ua=function(a){for(var b=0,d=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)b+=a.offsetLeft-a.scrollLeft,d+=a.offsetTop-a.scrollTop,a=a.offsetParent;return{top:d,left:b}};z.Oa=function(){return this.controls.M};
z.Ma=function(){return{x:this.v.position.x,y:this.v.position.y}};z.kb=function(a,b,d){var c=this.controls.object.position.x,f=this.controls.object.position.y,g=this.controls.M;"number"!==typeof a&&(a=c);"number"!==typeof b&&(b=f);"number"!==typeof d&&(d=g);this.controls.T(c-a);this.controls.U(-b-f);this.controls.wa(d);this.controls.update(!0)};J.prototype.apply(Z.prototype);window.MakeItZoom=Z;Z.prototype.addZoomable=Z.prototype.Ha;Z.prototype.removeZoomable=Z.prototype.Xa;Z.prototype.zoomTo=Z.prototype.kb;
Z.prototype.getCurrentScale=Z.prototype.Oa;Z.prototype.getCenter=Z.prototype.Ma;Z.prototype.getOffset=Z.prototype.ua;Z.prototype.getContainer=Z.prototype.Na;Z.prototype.setEnableUserInteractions=Z.prototype.ab;
